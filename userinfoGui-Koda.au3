#include <ButtonConstants.au3>
#include <GUIConstantsEx.au3>
#include <GuiStatusBar.au3>
#include <ListViewConstants.au3>
#include <StaticConstants.au3>
#include <WindowsConstants.au3>
Opt("GUIResizeMode", $GUI_DOCKAUTO)
#Region ### START Koda GUI section ### Form=c:\usr\git\userinfo\koda\frmmain.kxf
$frmMain = GUICreate("User info", 1001, 701, -1, -1, BitOR($GUI_SS_DEFAULT_GUI,$WS_MAXIMIZEBOX,$WS_TABSTOP))
GUISetIcon("C:\usr\GIT\UserInfo\ActiveDirectory.ico", -1)
GUICtrlCreateGroup("Functions", 845, 5, 150, 612)
GUICtrlSetResizing(-1, $GUI_DOCKAUTO+$GUI_DOCKWIDTH)
$btnRefreshQuery = GUICtrlCreateButton("Refresh", 850, 20, 140, 40)
GUICtrlSetImage(-1, "C:\Windows\System32\shell32.dll", -239)
GUICtrlSetResizing(-1, $GUI_DOCKAUTO+$GUI_DOCKWIDTH+$GUI_DOCKHEIGHT)
GUICtrlSetTip(-1, "Refresh from AD")
$btnNewQuery = GUICtrlCreateButton("New Search", 850, 60, 140, 40)
GUICtrlSetImage(-1, "C:\Windows\System32\shell32.dll", -23)
GUICtrlSetResizing(-1, $GUI_DOCKAUTO+$GUI_DOCKWIDTH+$GUI_DOCKHEIGHT)
GUICtrlSetTip(-1, "Do another search")
$btnCountDeptUsers = GUICtrlCreateButton("Count Users of Department", 850, 120, 140, 20)
GUICtrlSetResizing(-1, $GUI_DOCKAUTO+$GUI_DOCKWIDTH+$GUI_DOCKHEIGHT)
GUICtrlSetTip(-1, "Count the number of users with the same department")
$btnDepartmentUsers = GUICtrlCreateButton("Show Users of Department", 850, 140, 140, 20)
GUICtrlSetResizing(-1, $GUI_DOCKAUTO+$GUI_DOCKWIDTH+$GUI_DOCKHEIGHT)
GUICtrlSetTip(-1, "List all colleagues")
$btnCompareUsers = GUICtrlCreateButton("Compare Users", 850, 160, 140, 20)
GUICtrlSetResizing(-1, $GUI_DOCKAUTO+$GUI_DOCKWIDTH+$GUI_DOCKHEIGHT)
GUICtrlSetTip(-1, "Compare group membership with other userId")
$btnCopyGroups = GUICtrlCreateButton("Copy Group List", 850, 180, 140, 20)
GUICtrlSetResizing(-1, $GUI_DOCKAUTO+$GUI_DOCKWIDTH+$GUI_DOCKHEIGHT)
GUICtrlSetTip(-1, "Copy the list of groups to clipboard")
$btnGroupMembers = GUICtrlCreateButton("Group members", 850, 200, 140, 20)
GUICtrlSetResizing(-1, $GUI_DOCKAUTO+$GUI_DOCKWIDTH+$GUI_DOCKHEIGHT)
GUICtrlSetTip(-1, "Show members of selected group")
$btnExit = GUICtrlCreateButton("Exit", 850, 562, 140, 40)
GUICtrlSetResizing(-1, $GUI_DOCKAUTO+$GUI_DOCKWIDTH+$GUI_DOCKHEIGHT)
GUICtrlSetTip(-1, "Guess...try and find out!")
GUICtrlCreateGroup("", -99, -99, 1, 1)
$lblName = GUICtrlCreateLabel("Name:", 22, 10, 90, 17)
$lblNameValue = GUICtrlCreateLabel("fetching...", 112, 10, 300, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblUserId = GUICtrlCreateLabel("User ID:", 422, 10, 90, 17)
$lblUserIdValue = GUICtrlCreateLabel("fetching...", 525, 10, 300, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblOU = GUICtrlCreateLabel("OU:", 22, 30, 90, 17)
$lblOUValue = GUICtrlCreateLabel("fetching...", 112, 30, 300, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblTelephone = GUICtrlCreateLabel("Telephone:", 422, 30, 90, 17)
$lblTelephoneValue = GUICtrlCreateLabel("fetching...", 525, 30, 300, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblDepartment = GUICtrlCreateLabel("Department:", 22, 50, 90, 17)
$lblDepartmentValue = GUICtrlCreateLabel("fetching...", 112, 50, 300, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblDomain = GUICtrlCreateLabel("Domain:", 422, 50, 90, 17)
$lblDomainValue = GUICtrlCreateLabel("fetching...", 525, 50, 300, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblEmail = GUICtrlCreateLabel("Email:", 22, 70, 90, 17)
$lblEmailValue = GUICtrlCreateLabel("fetching...", 112, 70, 300, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblLocation = GUICtrlCreateLabel("Location:", 422, 70, 90, 17)
$lblLocationValue = GUICtrlCreateLabel("fetching...", 525, 70, 300, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblAddress = GUICtrlCreateLabel("Address:", 22, 90, 90, 17)
$lblAddressValue = GUICtrlCreateLabel("fetching...", 112, 90, 300, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblOffice = GUICtrlCreateLabel("Office:", 422, 90, 90, 17)
$lblOfficeValue = GUICtrlCreateLabel("fetching...", 525, 90, 300, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblLastUpdate = GUICtrlCreateLabel("Last update:", 22, 110, 90, 17)
$lblLastUpdateValue = GUICtrlCreateLabel("fetching...", 112, 110, 125, 17, $SS_SUNKEN)
$lblExpiration = GUICtrlCreateLabel("Valid till:", 242, 110, 44, 17)
$lblExpirationValue = GUICtrlCreateLabel("fetching...", 287, 110, 125, 17, $SS_SUNKEN)
$lblPwRequired = GUICtrlCreateLabel("PW Required:", 422, 110, 90, 17)
$lblPwRequiredValue = GUICtrlCreateLabel("-", 525, 110, 30, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblPWChange = GUICtrlCreateLabel("Change is ...", 572, 110, 253, 17)
$lblAccountLocked = GUICtrlCreateLabel("Locked/Deact:", 22, 130, 90, 17)
$lblAccountLockedValue = GUICtrlCreateLabel("-", 112, 130, 30, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblDeactivated = GUICtrlCreateLabel("/", 148, 130, 10, 17, $SS_CENTER)
$lblDeactivatedValue = GUICtrlCreateLabel("-", 162, 130, 30, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblCreatedDate = GUICtrlCreateLabel("Created on:", 422, 130, 90, 17)
$lblCreatedDateValue = GUICtrlCreateLabel("fetching...", 525, 130, 125, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblBadLoginCount = GUICtrlCreateLabel("Failed count:", 22, 150, 90, 17)
$lblBadLoginCountValue = GUICtrlCreateLabel("-", 112, 150, 30, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblLastLogon = GUICtrlCreateLabel("Last logon:", 422, 150, 90, 17)
$lblLastLogonValue = GUICtrlCreateLabel("fetching...", 525, 150, 125, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblHomeDirectory = GUICtrlCreateLabel("Home directory:", 22, 170, 90, 17)
$lblHomeDirectoryValue = GUICtrlCreateLabel("fetching...", 112, 170, 300, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblHomeDrive = GUICtrlCreateLabel("Home drive:", 422, 170, 90, 17)
$lblHomeDriveValue = GUICtrlCreateLabel("fetching...", 525, 170, 125, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblLogonScript = GUICtrlCreateLabel("Loginscript:", 22, 190, 90, 17)
$lblLogonScriptValue = GUICtrlCreateLabel("fetching...", 112, 190, 300, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lblProfilePath = GUICtrlCreateLabel("Profile Path:", 422, 190, 90, 17)
$lblProfilePathValue = GUICtrlCreateLabel("fetching...", 525, 190, 300, 17, $SS_SUNKEN)
GUICtrlSetFont(-1, -1, 400, 0, "MS Sans Serif")
$lstGroupMembership = GUICtrlCreateListView("Groupname|samAccountName|Group type|Member of|Scope", 22, 215, 803, 400)
GUICtrlSendMsg(-1, $LVM_SETCOLUMNWIDTH, 0, 50)
GUICtrlSendMsg(-1, $LVM_SETCOLUMNWIDTH, 1, 50)
GUICtrlSendMsg(-1, $LVM_SETCOLUMNWIDTH, 2, 50)
GUICtrlSendMsg(-1, $LVM_SETCOLUMNWIDTH, 3, 50)
GUICtrlSendMsg(-1, $LVM_SETCOLUMNWIDTH, 4, 50)
$sbMain = _GUICtrlStatusBar_Create($frmMain)
GUISetState(@SW_SHOW)
#EndRegion ### END Koda GUI section ###

While 1
	$nMsg = GUIGetMsg()
	Switch $nMsg
		Case $GUI_EVENT_CLOSE
			Exit

		Case $btnRefreshQuery
		Case $btnNewQuery
	EndSwitch
WEnd
